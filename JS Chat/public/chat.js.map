{"version":3,"file":"chat.js","mappings":"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","sources":["webpack://project2/./src/listeners.js","webpack://project2/./src/messageRefresh.js","webpack://project2/./src/render.js","webpack://project2/./src/services.js","webpack://project2/./src/sessionCheck.js","webpack://project2/./src/state.js","webpack://project2/webpack/bootstrap","webpack://project2/webpack/runtime/define property getters","webpack://project2/webpack/runtime/hasOwnProperty shorthand","webpack://project2/webpack/runtime/make namespace object","webpack://project2/./src/chat.js"],"sourcesContent":["import { fetchLogin, fetchLogout, fetchMessages, fetchAddMessage } from './services';\r\nimport { waitOnLogin, login, logout, setMessages, setSessions, setError, addMessage, waitOnMessages} from './state';\r\nimport render, { renderMessages } from './render';\r\n\r\nexport function handleLogin({ state, appEl, startMessageRefresh }) {\r\n  appEl.addEventListener('submit', (e) => {\r\n    if (!e.target.classList.contains('login-form')) {\r\n      return;\r\n    }\r\n    e.preventDefault();\r\n\r\n    const username = appEl.querySelector('.login-username').value;\r\n\r\n    waitOnLogin();\r\n    render({ state, appEl });\r\n    fetchLogin(username)\r\n      .then(response => {\r\n        const { allMessages, allSessions } = response;\r\n        login();\r\n        setMessages(allMessages);\r\n        setSessions(allSessions);\r\n        render({ state, appEl });\r\n        startMessageRefresh();\r\n      })\r\n      .catch(err => {\r\n        state.isLoginPending = false; \r\n        setError(err?.error || 'default');\r\n        render({ state, appEl });\r\n      });\r\n  });\r\n}\r\n\r\nfunction handleLogout({ state, appEl }) {\r\n  appEl.addEventListener('click', (e) => {\r\n    if (e.target.classList.contains('controls-logout')) {\r\n      logout();\r\n      render({ state, appEl });\r\n      fetchLogout().catch(err => {\r\n        setError(err?.error || 'default');\r\n        render({ state, appEl });\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nfunction handleMessageAddition({ state, appEl, startMessageRefresh }) {\r\n  appEl.addEventListener('submit', (e) => {\r\n    if (!e.target.classList.contains('add-form')) {\r\n      return;\r\n    }\r\n      e.preventDefault();\r\n      const message = appEl.querySelector('.add-message').value;\r\n      render({ state, appEl });\r\n      fetchAddMessage(message)\r\n        .then(response => {\r\n          addMessage(response);\r\n          render({ state, appEl });\r\n          startMessageRefresh();\r\n        })\r\n        .catch(err => {\r\n          setError(err?.error || 'default');\r\n          render({ state, appEl });\r\n        });\r\n  });\r\n}\r\n\r\nfunction enableButton({ appEl }) {\r\n  appEl.addEventListener('input', (e) => {\r\n    const messageInput = appEl.querySelector('.add-message');\r\n    const submitButton = appEl.querySelector('.add-button');\r\n    submitButton.disabled = messageInput.value.trim() === '';\r\n  });\r\n}\r\n\r\nexport function addEventListeners({ state, appEl, startMessageRefresh }) {\r\n  handleLogin({ state, appEl, startMessageRefresh });\r\n  handleLogout({ state, appEl });\r\n  handleMessageAddition({ state, appEl, startMessageRefresh });\r\n  enableButton({ appEl });\r\n}\r\n\r\n","import state from './state';\r\nimport { fetchMessages } from './services';\r\nimport { setMessages, setSessions, setError } from './state';\r\nimport render, { renderMessages } from './render';\r\n\r\nconst appEl = document.querySelector('#app');\r\n\r\nexport function startMessageRefresh() {\r\n    clearInterval(state.refreshIntervalId);\r\n    state.refreshIntervalId = setInterval(() => {\r\n      if (state.isLoggedIn) {\r\n        fetchMessages().then(response => {\r\n          const { allMessages, allSessions } = response;\r\n          setMessages(allMessages);\r\n          setSessions(allSessions);\r\n          state.error = '';\r\n          renderMessages({ state, appEl });\r\n        }).catch(err => {\r\n          setError(err?.error || 'default');\r\n          render({ state, appEl });\r\n        });\r\n      }\r\n    }, 5000);\r\n  }\r\n","function render ({ state, appEl }) {\r\n    const html = `\r\n        ${getStatusHtml(state)}\r\n        ${getLoginHtml(state)}\r\n        ${getContentHtml({ state })}\r\n    `;\r\n    appEl.innerHTML = html;\r\n  }\r\n  \r\nexport function renderMessages ({ state, appEl }) {\r\n    const userListEl = appEl.querySelector('.users');\r\n    const messagesEl = appEl.querySelector('.messages');\r\n  \r\n    userListEl.innerHTML = getUsersHtml(state);\r\n    messagesEl.innerHTML = getMessagesHtml(state);\r\n}\r\n  \r\nfunction getStatusHtml (state) {\r\n    return `\r\n        <div class=\"status\">${state.error}</div>\r\n    `;\r\n}\r\n  \r\nfunction getLoginHtml (state) {\r\n  if (state.isLoginPending) {\r\n    return `\r\n      <p class=\"status\">Loading chat...</p>\r\n    `\r\n  }\r\n  if (state.isLoggedIn) {\r\n    return ``;\r\n  }\r\n  return `\r\n      <div class=\"login\">\r\n        <form class=\"login-form\" action=\"#/login\">\r\n          <label>Username: </label>\r\n          <input class=\"login-username\" value=\"\">\r\n          <button class=\"login-button\" type=\"submit\">Login</button>\r\n        </form>\r\n      </div>\r\n  `;\r\n}\r\n  \r\nfunction getContentHtml ({ state }) {\r\n    if (!state.isLoggedIn) {\r\n      return ``;\r\n    }\r\n    return `\r\n        <div class=\"user-list\">\r\n          <h2>Users:</h2>\r\n          <ul class=\"users\">${getUsersHtml(state)}</ul>\r\n          ${getControlsHtml()}\r\n        </div>\r\n        <div class=\"chat-list\">\r\n          <h2>Messages:</h2>\r\n          <ul class=\"messages\">${getMessagesHtml(state)}</ul>  \r\n          ${getAddMessageHtml()}\r\n        </div>\r\n    `;\r\n}\r\n  \r\nfunction getUsersHtml(state) {\r\n    const usernames = Object.values(state.sessions).map(user => user.username);\r\n    const uniqueUsernames = [];\r\n    usernames.forEach(username => {\r\n      if (!uniqueUsernames.includes(username)) {\r\n        uniqueUsernames.push(username);\r\n      }\r\n    });\r\n    const usersHtml = uniqueUsernames.map(username => `\r\n      <li class=\"user\">\r\n        <p>${username}</p>\r\n      </li>\r\n    `).join('');\r\n    return usersHtml || ``;\r\n  }\r\n  \r\nfunction getMessagesHtml (state) {\r\n    const messagesHtml = Object.values(state.messages).map(data => {\r\n      const { message, username } = data;\r\n      return `\r\n        <li class=\"message\">\r\n          <p class=\"username\">${username}: </p>\r\n          <p>${message}</p>\r\n        </li>\r\n        `;\r\n    }).join('') || ``;\r\n    return messagesHtml;\r\n}\r\n  \r\nfunction getAddMessageHtml () {\r\n    return `\r\n      <form class=\"add-form\" action=\"#/add\">\r\n        <input class=\"add-message\">\r\n        <button type=\"submit\" class=\"add-button\"  disabled>send</button>\r\n      </form>\r\n    `;\r\n}\r\n  \r\nfunction getControlsHtml () {\r\n    return `\r\n      <div class=\"controls\">\r\n        <button class=\"controls-logout\">Logout</button>\r\n      </div>\r\n    `;\r\n}\r\n  \r\nexport default render","export function fetchAddMessage (message) {\r\n    return fetch('/api/messages', {\r\n      method: 'POST',\r\n      headers: new Headers({\r\n        'content-type': 'application/json',\r\n      }),\r\n      body: JSON.stringify({ message }),\r\n    })\r\n      .catch(() => Promise.reject({ error: 'network-error' }))\r\n      .then( response => {\r\n        if(!response.ok) {\r\n          return response.json().then( err => Promise.reject(err) );\r\n        }\r\n        return response.json(); \r\n      });\r\n    }\r\n  \r\n  \r\n  export function fetchMessages () {\r\n    return fetch('/api/messages')\r\n      .catch(() => Promise.reject({ error: 'network-error' }))\r\n      .then( response => {\r\n        if(!response.ok) {\r\n          return response.json().then( err => Promise.reject(err) );\r\n        }\r\n        return response.json(); \r\n      });\r\n    }\r\n  \r\n  export function fetchSession () {\r\n    return fetch('/api/session', {\r\n      method: 'GET',\r\n    })\r\n      .catch(() => Promise.reject({ error: 'network-error' }))\r\n      .then( response => {\r\n        if(!response.ok) {\r\n          return response.json().then( err => Promise.reject(err) );\r\n        }\r\n        return response.json(); \r\n      });\r\n    }\r\n  \r\n  export function fetchLogout () {\r\n    return fetch('/api/session', {\r\n      method: 'DELETE',\r\n    })\r\n      .catch(() => Promise.reject({ error: 'network-error' }))\r\n      .then( response => {\r\n        if(!response.ok) {\r\n          return response.json().then( err => Promise.reject(err) );\r\n        }\r\n        return response.json(); \r\n      });\r\n    }\r\n  \r\n  export function fetchLogin (username) {\r\n    return fetch('/api/session', {\r\n      method: 'POST',\r\n      headers: new Headers({\r\n        'content-type': 'application/json'\r\n      }),\r\n      body: JSON.stringify({ username }),\r\n    })\r\n      .catch(() => Promise.reject({ error: 'network-error' }))\r\n      .then( response => {\r\n        if(!response.ok) {\r\n          return response.json().then( err => Promise.reject(err) );\r\n        }\r\n        return response.json(); \r\n      });\r\n    }\r\n\r\n","import state from './state';\r\nimport { fetchSession, fetchMessages } from './services';\r\nimport { login, setMessages, setSessions} from './state';\r\nimport render from './render';\r\nimport { startMessageRefresh } from './messageRefresh';\r\n\r\nexport function checkForSession (appEl) {\r\n    fetchSession()\r\n      .then(() => {\r\n        login();\r\n        render({ state, appEl });\r\n        startMessageRefresh(appEl);\r\n        return fetchMessages();\r\n      })\r\n      .catch(err => {\r\n        if (err?.error === 'auth-missing') {\r\n          return Promise.reject(new Error('no-session'));\r\n        }\r\n        return Promise.reject(err);\r\n      })\r\n      .then(response => {\r\n        const { allMessages, allSessions } = response;\r\n        setMessages(allMessages);\r\n        setSessions(allSessions);\r\n        render({ state, appEl });\r\n      })\r\n}\r\n","const ERROR_MESSAGES = {\r\n  'network-error': 'Your internet is bad. Please try again.',\r\n  'auth-insufficient': 'Cannot use dog as username, please try again.',\r\n  'required-username': 'Please enter a valid username.',\r\n  'auth-missing': 'Authentication is missing. Please login.',\r\n  'no-session': 'No active session found. Please login again.',\r\n  'default': 'Something went wrong. Please try again.',\r\n};\r\n\r\nconst state = {\r\n  messages: {},\r\n  sessions: {},\r\n  isLoggedIn: false,\r\n  isLoginPending: false,\r\n  error: '',\r\n};\r\n\r\nexport function waitOnLogin () {\r\n  state.isLoggedIn = false;\r\n  state.isLoginPending = true;\r\n  state.messages = {};\r\n  state.sessions = {};\r\n  state.error = '';\r\n}\r\n\r\nexport function login () {\r\n  state.isLoggedIn = true;\r\n  state.isLoginPending = false;\r\n  state.error = '';\r\n}\r\n\r\nexport function logout () {\r\n  state.isLoggedIn = false;\r\n  state.isLoginPending = false;\r\n  state.messages = {};\r\n  state.sessions = {};\r\n  state.error = '';\r\n}\r\n\r\nexport function waitOnMessages () {\r\n  state.messages = {};\r\n  state.error = '';\r\n}\r\n\r\nexport function setMessages (messages) {\r\n  state.messages = messages;\r\n  state.error = '';\r\n}\r\n\r\nexport function setSessions (sessions) {\r\n  state.sessions = sessions;\r\n  state.error = '';\r\n}\r\n\r\n\r\nexport function addMessage (message) {\r\n  const { id } = message;\r\n  state.messages[id] = message;\r\n  state.error = '';\r\n}\r\n\r\n\r\nexport function setError (error) {\r\n  if (!error) {\r\n    state.error = '';\r\n    return;\r\n  }\r\n  state.error = ERROR_MESSAGES[error] || ERROR_MESSAGES.default;\r\n}\r\nexport default state;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import state from './state';\r\nimport render, { renderMessages } from './render';\r\nimport { addEventListeners } from './listeners';\r\nimport { startMessageRefresh } from './messageRefresh';\r\nimport { checkForSession } from './sessionCheck';\r\n\r\nconst appEl = document.querySelector('#app');\r\n\r\n\r\nfunction init() {\r\n  render({ state, appEl });\r\n  addEventListeners({ state, appEl, startMessageRefresh });\r\n  checkForSession(appEl);\r\n}\r\n\r\ninit();\r\n"],"names":["fetchLogin","fetchLogout","fetchMessages","fetchAddMessage","waitOnLogin","login","logout","setMessages","setSessions","setError","addMessage","waitOnMessages","render","renderMessages","handleLogin","_ref","state","appEl","startMessageRefresh","addEventListener","e","target","classList","contains","preventDefault","username","querySelector","value","then","response","allMessages","allSessions","err","isLoginPending","error","handleLogout","_ref2","handleMessageAddition","_ref3","message","enableButton","_ref4","messageInput","submitButton","disabled","trim","addEventListeners","_ref5","document","clearInterval","refreshIntervalId","setInterval","isLoggedIn","html","concat","getStatusHtml","getLoginHtml","getContentHtml","innerHTML","userListEl","messagesEl","getUsersHtml","getMessagesHtml","getControlsHtml","getAddMessageHtml","usernames","Object","values","sessions","map","user","uniqueUsernames","forEach","includes","push","usersHtml","join","messagesHtml","messages","data","fetch","method","headers","Headers","body","JSON","stringify","Promise","reject","ok","json","fetchSession","checkForSession","Error","ERROR_MESSAGES","id","init"],"sourceRoot":""}